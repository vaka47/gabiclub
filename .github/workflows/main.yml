name: ðŸš€ Deploy to REG.RU

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Checkout repo
        uses: actions/checkout@v3

      - name: ðŸ› ï¸ Setup SSH Key
        run: |
          echo "${{ secrets.REG_RU_DEPLOY_KEY }}" > ~/.ssh/id_deploy
          chmod 600 ~/.ssh/id_deploy

      - name: ðŸ•µï¸ Show SSH key fingerprint
        run: |
          echo "ðŸ” SSH key fingerprint:"
          ssh-keygen -lf ~/.ssh/id_deploy || echo "âŒ ÐšÐ»ÑŽÑ‡ Ð½Ðµ Ð¿Ñ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð½"

      - name: ðŸ” Add server to known_hosts
        run: |
          mkdir -p ~/.ssh
          ssh-keyscan server295.hosting.reg.ru >> ~/.ssh/known_hosts

      - name: ðŸš€ Deploy to REG.RU via SSH
        run: |
          ssh -i ~/.ssh/id_deploy u3187320@server295.hosting.reg.ru 'ls -la'


